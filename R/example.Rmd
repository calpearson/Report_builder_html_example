---
title: "Untitled"
author: "callum pearson"
date: "2026-02-19"
output:
  html_document:
    css: html_ukhsa.css # this needs to be in the same folder as the rmd file / the jpeg needs to be inside the same folder i.e. the UKHSA logo :) //  the html_ukhsa.css file can be opened in notes. you can change the image if you like here.
    toc: yes # this states that you should have a menu bar on the left.
    toc_float:
      collapsed: true
    toc_depth: 2
  markdown:
    wrap: 72 

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Section1
## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```
# Section2
## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


# Secton3
## Epidemiological Summary {.tabset}

### Interactive plot
```{r, echo=FALSE}
library(tidyverse)
library(plotly)
ggplotly(
  ggplot(mtcars, aes(x = hp, y = mpg, text = paste("Car:", rownames(mtcars), "<br>Cylinders:", cyl))) +
    geom_point(aes(color = factor(cyl))) +
    geom_smooth(method = "lm")
)
```


### info 2
```{r, echo=FALSE}
ggplot(mtcars, aes(x = factor(cyl), y = mpg)) +
  geom_boxplot() +
  labs(
    title = "MPG by Number of Cylinders",
    x = "Cylinders",
    y = "Miles per Gallon"
  ) +
  theme_minimal()
```


### info 3
```{r, echo=FALSE}
ggplot(mtcars, aes(x = hp, y = mpg)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Fuel Efficiency vs Horsepower",
    x = "Horsepower",
    y = "Miles per Gallon"
  ) +
  theme_minimal()
```

### Interactive table
```{r interactive-table, echo=FALSE}
library(DT)

# Create a filterable table for mtcars
datatable(
  mtcars,
  options = list(
    pageLength = 10,     # Number of rows per page
    autoWidth = TRUE,    # Adjust column width automatically
    scrollX = TRUE       # Enable horizontal scrolling if needed
  ),
  filter = "top",        # Adds filter boxes at the top of each column
  rownames = TRUE         # Keep car names
)
```

## Download data (csv)
```{r download-data, results='asis', echo=FALSE, warning=FALSE}
library(htmltools)

# Save CSV in the same folder
write.csv(mtcars, "mtcars_data.csv", row.names = TRUE)

# Provide a download link
tags$a(
  href = "mtcars_data.csv",
  download = "mtcars_data.csv",
  "Click here to download the data as CSV"
)
```

## Download data Button (csv)
```{r download-button, echo=FALSE, results='asis', warning=FALSE}
library(htmltools)

# Save CSV to the same folder
write.csv(mtcars, "mtcars_data.csv", row.names = TRUE)

# Create a download button
tags$button(
  type = "button",
  class = "btn btn-primary",  # Bootstrap style (works if your HTML uses bootstrap)
  onclick = "window.location.href='mtcars_data.csv'",
  "Download Data.csv"
)

```

## Download data (xlsx)
```{r, echo=FALSE, results='asis', warning=FALSE}
library(openxlsx)
library(dplyr)
library(htmltools)

# Create a new Excel workbook
wb <- createWorkbook()

# --- Sheet 1: mtcars ---
addWorksheet(wb, "mtcars")
writeData(wb, sheet = "mtcars", mtcars, rowNames = TRUE)

# --- Sheet 2: iris ---
addWorksheet(wb, "iris")
writeData(wb, sheet = "iris", iris, rowNames = FALSE)

# --- Save workbook ---
saveWorkbook(wb, "multi_tab_report.xlsx", overwrite = TRUE)

# --- Add download button in HTML ---
tags$button(
  type = "button",
  class = "btn btn-success",
  onclick = "window.location.href='multi_tab_report.xlsx'",
  "Download Excel Report"
)

headerStyle <- createStyle(fontColour = "#FFFFFF", fgFill = "#4F81BD", halign = "center", textDecoration = "Bold")
addStyle(wb, "mtcars", headerStyle, rows = 1, cols = 1:ncol(mtcars), gridExpand = TRUE)
addStyle(wb, "iris", headerStyle, rows = 1, cols = 1:ncol(iris), gridExpand = TRUE)

```

